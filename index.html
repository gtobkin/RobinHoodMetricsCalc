<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<!-- IT BEGINS! -->
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Robin Hood Foundation Metrics Calculator</title>
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
		<script>
  			$(document).ready(function() {
  				$(document).ready(function () {  
					var top = $('#output').offset().top - parseFloat($('#output').css('marginTop').replace(/auto/, 0));
					$(window).scroll(function (event) {
						
						// what the y position of the scroll is
						var y = $(this).scrollTop();
				  
				    	// whether that's below the form
				    	if (y >= top - 400) {
				      		// if so, add the fixed class
				      		$('#output').addClass('fixed');
				    	} else {
				      		// otherwise remove it
				      		$('#output').removeClass('fixed');
				    	}
				  	});
				});
	  		});
	  		function formatMoney(amount, decPlaces, thouSeparator, decSeparator) {
	  			var n = amount,
			    decPlaces = isNaN(decPlaces = Math.abs(decPlaces)) ? 2 : decPlaces,
			    decSeparator = decSeparator == undefined ? "." : decSeparator,
			    thouSeparator = thouSeparator == undefined ? "," : thouSeparator,
			    sign = n < 0 ? "-" : "",
			    i = parseInt(n = Math.abs(+n || 0).toFixed(decPlaces)) + "",
			    j = (j = i.length) > 3 ? j % 3 : 0;
			    return sign + "$" + (j ? i.substr(0, j) + thouSeparator : "") + i.substr(j).replace(/(\d{3})(?=\d)/g, "$1" + thouSeparator) + (decPlaces ? decSeparator + Math.abs(n - i).toFixed(decPlaces).slice(2) : "");
	  		};
	  		function parseField(input) {
				return parseFloat(input.replace(/[^\d.-]/g, ""));
			};
			var benefit;
			function updateBCRatio() {
				var funding = parseField($("#funding").val());
				var rhFactor = parseField($("#rhFactor").val())/100;
				var bcRatio = benefit * rhFactor / funding;
				if (isNaN(Math.round(bcRatio))) {
					$("#bcRatioDisplay").text("0:1");
				} else {
					$("#bcRatioDisplay").text(Math.round(bcRatio) + ":1");
				}
			};
		</script>
        <style>
        	h1.myh1 {
        		font-family: "Franklin Gothic Medium", "Franklin Gothic", "ITC Franklin Gothic", Arial, sans-serif;
        		color:rgb(0,89,143)
        	}
        	h2.myh2 {
        		font-family: "Franklin Gothic Medium", "Franklin Gothic", "ITC Franklin Gothic", Arial, sans-serif;
        		color:rgb(0,89,143)
        	}
        	p {
        		font-family:Verdana, Arial, Helvetica, sans-serif
        	}
        	p.sampleCharityOverlayText {
        		text-align:center;
        		margin:0;
        		padding:80px 0 0 0;
        		color:white;
        		text-shadow:2px 2px #000000;
        		font-size:48px;
        		font-family:"Franklin Gothic Medium", "Franklin Gothic", "ITC Franklin Gothic", Arial, sans-serif;
  				-moz-user-select: -moz-none;
			    -khtml-user-select: none;
    			-webkit-user-select: none;
    			-o-user-select: none;
    			user-select: none;
    			cursor:default
        	}
        	p.equationLine {
        		margin:0px;
        		padding:0px;
        		font-size:14px;
        		font-style:italic
        	}
        	div.topLevelFrame {
        		background:#EDEBE4;
        		max-width:1150px;
        		padding:10px;
        		margin:25px;
        		margin-left:auto;
        		margin-right:auto
        	}        	
        	div.sampleImageContainer {
        		width:350px;
        		height:225px
        	}
        	input {
        		float:right;
        		clear:both
        	}
        	input.bcRatio {
        		float:left
        	}
        	input.constant {
        		disabled:disabled;
        		background-color:lightgrey
        	}
        	li.metricsFactor {
        		padding-bottom:3px
        	}
        	#outputWrapper {
        		left:1530px;
        		top:1500px;
        		position:absolute;
        		margin-left:35px;
        		width:400px
        	}
        	#output {
        		position:absolute;
        		top:0;
        		background-color:rgb(189,231,37)
        	}
        	#output.fixed {
        		position:fixed;
        		top:400px
        	}
        </style>
    </head>
    <body>
    	
    	<div id="outputWrapper">
			<div id="output">
				<table>
					<tr>
						<td>
							Total impact:
						</td>
						<td>
							<p id="benefitDisplay">
								$500,000
							</p>
						</td>
					</tr>
					<tr>
						<td>
							Benefit/cost ratio:
						</td>
						<td>
							<p id="bcRatioDisplay">
								20:1
							</p>
						</td>
					</tr>
				</table>
		  	</div>
	  	</div>
    	
    	<!-- Intro: introduce the calculator, let the user pick a sample charity -->
    	
        <div id="intro" class="topLevelFrame">
        	<h1 class="myh1">
        		WELCOME TO THE ROBIN HOOD METRICS CALCULATOR!
    		</h1>
        	<p>
        		At Robin Hood, we have a unique approach to fighting poverty. Using our research-driven metrics, we’re
        	able to judge the social impact of a given charity on impoverished New Yorkers and direct funding to where
        	it will do the greatest good.
        	</p>
        	<p>
	        	This Metrics Calculator will let you experience evaluating the impact of a poverty-fighting program.
    	    	Click on one of the sample hypothetical charities below to get started.
        	</p>
        	<table border=0 width="100%" style="border-spacing:25px">
        		<td>
        			<div class="sampleImageContainer" style="background-image:url('img/home_health_aide_scaled.png')">
        				<p class="sampleCharityOverlayText">
        					Job Training
        				</p>
        			</div>
        		</td>
        		<td>
        			<div class="sampleImageContainer" style="background-image:url('img/high_school_scaled.jpg')">
        				<p class="sampleCharityOverlayText">
        					High School
        				</p>
        			</div>
        		</td>
        		<td>
					<div class="sampleImageContainer" style="background-image:url('img/foodpantry_scaled.jpg')">
    					<p class="sampleCharityOverlayText">
        					Food Security
        				</p>
        			</div>
        		</td>
        	</table>
        </div>
        
        <!-- Background: display background text on the selected charity -->
        
        <div id="background" class="topLevelFrame">
        	<h2 class="myh2">
        		Manhattan Nursing Aide Career Center
        	</h2>
        	<p>
        		This hypothetical charity is modeled after Robin Hood’s Job Training and Economic Security portfolio.
        	</p>
        	<p>
        		The Manhattan Nursing Aide Career Center (MNACC) provides training and job placement services to New York’s un- and under-employed,
        		helping them find work as a nursing aide. This career track is a promising route out of poverty for a variety of reasons:
        		it pays around $9.50 an hour, has reasonable education requirements, and is expected to experience growing demand as Baby Boomers
        		retire in larger numbers.
        	</p>
        	<p>
        		Another advantage for MNACC is that trainees are primarily women and may not speak English as a primary language, suggesting they
        		would otherwise be disadvantaged in the job market.
        	</p>
			<p>
				Here, the grant under consideration will pay for additional instructors and support staff, letting the Career Center handle
				additional trainees.
        	</p>
        </div>
        
        <!-- Impact: enumerate the various benefits of the selected program and show associated formulas + factors -->
        
        <div id="impact" class="topLevelFrame">
        	<h2 class="myh2">
        		Understanding Impact
        	</h2>
        	<p>
        		Robin Hood identifies the specific ways each charity is improving the well-being of New York’s poor.
        		We then use our set of metrics research to estimate a value for each of those effects.
        	</p>
        	<p>
        		Here, the Manhattan Nursing Aide Resource Center accomplishes several things:
        	</p>
        	<ol>
        		<li class="metricsFactor">It provides an immediate wage boost for trainees placed in jobs.</li>
        		<li class="metricsFactor">For trainees retained in their new job longer than a year, it also provides a long-term wage boost.</li>
        	</ol>
        	<p>
        		Each of these metrics has an associated formula for estimating its contribution to New Yorkers’ quality of life,
        		based on Robin Hood’s oversight of its funded grantees as well as wider research. Here they are for the above metrics:
        	</p>
        	<ol>
        		<li style="margin-top:15px">
        			Job training and placement: Impact of initial wage for full-time employees (grantee reported pre-training wage data)
    			    <p class="equationLine" style="text-indent:1cm;margin-top:5px">
     		   			Impact = P.D.V. of the following equation:
      		 		</p>
      		 		<p class="equationLine" style="text-indent:2cm">
     		   			XX participants enter the program
      		 		</p>
      		 		<p class="equationLine" style="text-indent:2cm">
     		   			* XX percent of participants who enter training graduate and remain employed for one year solely because of the program
      		 		</p>
      		 		<p class="equationLine" style="text-indent:2cm">
     		   			* [ $XX average annual post-training earnings
      		 		</p>
      		 		<p class="equationLine" style="text-indent:3cm">
     		   			- $XX average annual pre-training earnings ]
      		 		</p>
        		</li>
        		<li style="margin-top:15px">
        			Job training and placement: Impact of future wage increases over and above wage of initial placement
    			    <p class="equationLine" style="text-indent:1cm;margin-top:5px">
     		   			Impact = P.D.V. of the following equation:
      		 		</p>
    			    <p class="equationLine" style="text-indent:2cm;">
     		   			XX participants enter the program
      		 		</p>
    			    <p class="equationLine" style="text-indent:2cm">
     		   			* XX percent of participants who enter training graduate and remain employed for at least one year solely because of the program
      		 		</p>
    			    <p class="equationLine" style="text-indent:2cm">
     		   			* XX percent of employed participants who receive a promotion/wage boost
      		 		</p>
    			    <p class="equationLine" style="text-indent:2cm">
     		   			* $XX average annual wage increase
      		 		</p>
        		</li>
        	</ol>
        	<p style="font-style:italic">
        		Wait, what’s this “P.D.V.” business?
        	</p>
        	<p>
        		P.D.V. stands for “present discounted value,” and is a way for us to account for positive outcomes now being worth more (or, equivalently,
        		being more expensive) than positive outcomes in the future. If we didn’t correct for this, we’d reach some pretty bizarre conclusions.
        		For example, it would always make sense to leave our donors’ money invested and earning interest (so we could disburse more the next year),
        		so we’d leave it invested and never actually spend anything!
        		<br />
        		<br />
        		One way to think about is that the same outcome should cost less in the future than it does today, because we can earn interest on the money
        		used to pay for it before we need to spend it. If it always costs $1 to provide a meal, then it’s worth spending $1 now to provide a meal now
        		(since that’s what it costs). However, it’s not worth spending $1 now to provide a meal ten years in the future; that’s too much. Instead, we
        		could have set $0.82 aside, let it earn 2% interest over ten years, and then spend that resulting $1 on the meal.
        	</p>
        </div>
        
        <div id="calculator" class="topLevelFrame">
        	<h2 class="myh2">
        		Adding It Up
        	</h2>
        	<p>
        		Now that we know how Robin Hood would approach evaluating the various ways the Manhattan Nursing Aide Career Center benefits poor New Yorkers,
        		let’s actually get some numbers. Below are fields for each of the factors in our metrics equations above. Fill them in with any values you
        		like and the corresponding social impact will be calculated and shown here.
        		<br />
        		<br />
        		Some factors are greyed out, with default values already filled in. These factors are usually constant across different grantees. Robin Hood
        		estimates the average annual earnings of high-school graduates with no further education that begin the year unemployed as $11,200, for
        		example, and we treat a two-bedroom apartment as always costing about $16,840 in rent.
        	</p>
        	
        	<p style="font-style:italic">
        		Breakdown:
        	</p>
        	<table border=0 width="100%">
        		<tr>
        			<td width="75%">
        				<ol start=1 style="margin:0px">
        					<li class="metricsFactor">Job training and placement: Impact of initial wage for full-time employees (grantee reported pre-training wage data)</li>
        				</ol>
        			</td>
        			<td id="metric1">
        				$123,456
        			</td>
        		</tr>
        		<tr>
        			<td width="70%">
        				<ol start=2 style="margin:0px">
        					<li class="metricsFactor">Job training and placement: Impact of future wage increases over and above wage of initial placement</li>
        				</ol>
        			</td>
        			<td id="metric2">
        				$123,456
        			</td>
        		</tr>
        	</table>
        	
        	<p style="font-style:italic">
        		Metrics factors:
        	</p>
        	
        	<form id="metricsFactors">
	        	<ol>
	        		<li class="metricsFactor">
	        			Job training and placement: Impact of initial wage for full-time employees (grantee reported pre-training wage data)
						<ul style="margin:0px">
							<li class="metricsFactor">
								How many participants enter training?
								<input class="impact" type="number" id="01a" value=50>
							</li>
							<li class="metricsFactor">
								Of those, what percent graduate and remain employed for at least one year solely because of the program?
								<input class="impact" type="number" id="01b" value="80%">
							</li>
							<li class="metricsFactor">
								What is the participants’ average annual post-training earnings?
								<input class="impact" type="number" id="01c" value="$15,000">
							</li>
							<li class="metricsFactor">
								What is the participants’ average annual pre-training earnings?
								<input class="impact" type="number" id="01d" value="$9,000">
							</li>
						</ul>
	        		</li>
	        		<li class="metricsFactor">
	        			Job training and placement: Impact of future wage increases over and above wage of initial placement
						<ul style="margin:0px">
							<li class="metricsFactor">
								How many participants enter training?
								<input class="constant impact" type="number" id="02a">
							</li>
							<li class="metricsFactor">
								Of those, what percent graduate and remain employed for at least one year solely because of the program?
								<input class="constant impact" type="number" id="02b">
							</li>
							<li class="metricsFactor">
								What is the participants’ average annual post-training earnings?
								<input class="constant impact" type="number" id="02c">
							</li>
							<li class="metricsFactor">
								What is the participants’ average annual pre-training earnings?
								<input class="constant impact" type="number" id="02d">
							</li>
						</ul>
	        		</li>
	        	</ol>
	        </form>
        </div>
	
		<div id="cost" class="topLevelFrame">
        	<h2 class="myh2">
        		Adjusting for Cost
        	</h2>
        	<p>
        		Figuring out the positive impact of a potential grantee is, unfortunately, only half of the equation. When
        		selecting which programs to fund, we also need to weigh their cost. Our ideal nonprofit does a lot with a little.
        		<br />
        		<br />
        		Another key factor comes into play here to help us only “take credit” for outcomes actually attributable to Robin
        		Hood. We call it the Robin Hood Factor, and it estimates what proportion of a given grantee’s activities are actually
        		due to our funding. If a charity uses their $100,000 budget to hand out 100,000 free meals and we gave them $20,000,
        		we only take credit for 20,000 meals - one-fifth, our share - not the full 100,000.
        		<br />
        		<br />
        		The Robin Hood Factor can still be 100% when we fund less than 100% of the program’s budget, however. This happens
        		when our funding is necessary for the program to take place or have an impact - qualifying for matching funding or
        		government grants is a common example.
        		<br />
        		<br />
        		Fill in the Manhattan Nursing Aide Career Center’s estimated funding requirements (from Robin Hood) and the Robin Hood
        		Factor and we’ll combine them with the estimated benefits from above to determine the ratio of expected, Robin
        		Hood-attributable benefits to Robin Hood cost. This benefit-cost ratio, the final link in the chain, is a big part
        		(but only a part) in whether we decide to fund an applicant grantee.
        	</p>
        	<table width="60%">
        		<tr>
        			<td>
        				How much funding would the program require?
        			</td>
        			<td>
        				<input id="funding" class="bcRatio" type="number" style="float:left">
        			</td>
        		</tr>
        		<tr>
        			<td>
        				What’s the estimated Robin Hood Factor?
        			</td>
        			<td>
        				<input id="rhFactor" class="bcRatio" type="number" style="float:left">
        			</td>
        		</tr>
        	</table>
		</div>
	
		<script>
			// Defined in the charity-specific script block as we'll need to redefine updateBenefits for each charity's set of metrics
			function updateBenefits() {
				$("#02a").val($("#01a").val());
				$("#02b").val($("#01b").val());
				$("#02c").val($("#01c").val());
				$("#02d").val($("#01d").val());
				var values = new Array();
				values[0] = parseField($("#01a").val());
				values[1] = parseField($("#01b").val())/100;
				values[2] = parseField($("#01c").val());
				values[3] = parseField($("#01d").val());
				values[4] = values[0];
				values[5] = values[1];
				values[6] = values[2];
				values[7] = values[3];
				var metric1 = values[0] * values[1] * (values[2]-values[3]);
				var metric2 = values[4] * values[5] * (values[6]-values[7]);
				$("#metric1").text(formatMoney(metric1));
				$("#metric2").text(formatMoney(metric2));
				benefit = metric1 + metric2;
				$("#benefitDisplay").text(formatMoney(benefit));
				updateBCRatio();
			};
			
			// Starting values follow
			$("#01a").val("50"); // # participants
			$("#01b").val("80%"); // % graduate, get job, retain 1yr
			$("#01c").val("$15,000"); // avg post-training salary
			$("#01d").val("$9,000"); // avg pre-training salary
			
			$("#funding").val("$100,000");
			$("#rhFactor").val("50%");
			// End of starting values
			
			updateBenefits();
		
			$("input.impact").on('input keyup', function() {
				updateBenefits(); // this will also, indirectly, call updateBCRatio() for us
			});
			
			$("input.bcRatio").on('input keyup', function() {
				updateBCRatio();
			});
		</script>
		
    </body>
</html>
